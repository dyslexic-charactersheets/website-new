<template>
  <form
    id="build-form"
    class="build-form"
    data-edition=""
    data-build=""
    data-ancestry=""
    data-heritage=""
    data-background=""
    data-class=""
    data-multiclass="[]"
    data-archetype="[]"
    data-option-diehard=""
    data-option-debug=""
    data-option-free-archetype=""
    data-option-ancestry-paragon=""
    data-option-automatic-bonus-progression=""
    data-option-proficiency-without-level=""
  >
    {{#> Slideshow 
      id='slides-character'
      vertical=true
      forward="#milestones-character.current"
      slides=(array
        "start"
        "pick"
        "character"
        "pages"
        "colours"
        "picture"
        "download"
        "gm-pick"
        "gm-options"
        "gm-colours"
        "gm-download"
      )
    }}
      {{#> Slide jump="start" first="true"}}
        {{#> Place}}
          {{#> Row align="centre"}}
            {{> Picture src="/images/pathfinder2e.png" size="logo"}}
          {{/Row}}

          {{#> Row pad=true}}
            <h3>{{__ "Select your game edition"}}:</h3>
            {{> Spacer}}
            <p>
              {{__ "Language"}}:
              {{#> Button class="btn btn--light" on-click="body.currentMenu = language-menu"}}
                {{> Icon icon="globe"}}{{__ (languagename lang)}}
              {{/Button}}
            </p>
          {{/Row}}
          
          {{#> TileGrid grid="2-1"}}
            {{#> Button
              type="tile"
              on-click="build-form.edition=pf2-legacy;#slides-character.jump=pick"
            }}
              {{> Picture src="/images/pathfinder2e-classic.png" size="tile"}}
              <h2>Legacy</h2>
              <p>2019 Core Rulebook and OGL properties</p>
            {{/Button}}

            {{#> Button
              type="tile"
              on-click="build-form.edition=pf2-remaster;#slides-character.jump=pick"
            }}
              {{> Picture src="/images/pathfinder2e-remaster.png" size="tile"}}
              <h2>Remaster</h2>
              <p>2023 Player Core and ORC properties</p>
            {{/Button}}

            {{#> Button
              type="tile"
              on-click="build-form.edition=all;#slides-character.jump=pick"
            }}
              <h3>Use both</h3>
            {{/Button}}

          {{/TileGrid}}

          <p><a href="{{link lang 'legal'}}">Legal Information</a> &mdash; OGL and ORC.</p>
        {{/Place}}

      {{/Slide}}

      {{#> Slide jump="pick" }}
        {{#> Row align="centre"}}
          {{> Picture src="/images/pathfinder2e.png" size="logo"}}
        {{/Row}}
        
        {{#> Row pad=true}}
          <span>
            {{__ "Game edition"}}:
          </span>
          {{> Output bare=true var="build-form.edition|editionName"}}

          {{> Spacer}}
            
          <span>
            {{__ "Language"}}:
            {{#> Button class="btn btn--light" on-click="body.currentMenu = language-menu"}}
              {{> Icon icon="globe"}}{{__ (languagename lang)}}
            {{/Button}}
          </span>
        {{/Row}}

        {{#> TileGrid grid="2-2" }}
        
          {{#> Button 
            type="tile"
            on-click="#switch-character.current=character; #slides-character.jump=character"
          }}
            <div>
              {{> Picture src="/images/single.png" size="tile"}}
            </div>
            <h3>{{__ "Character"}}</h3>
          {{/Button}}

          {{#> Button 
            type="tile"
            on-click="#switch-character.current=gm; #slides-character.jump=gm-pick"
          }}
            {{> Picture src="/images/gm.png" size="tile"}}
            <h3>{{__ "GM"}}</h3>
          {{/Button}}

          {{#> Button
            type="tile"
            on-click="#switch-character.current=kingmaker; #slides-character.jump=kingmaker"
          }}  
            {{> Picture src="/images/kingmaker-logo2.png" size="logo"}}
          {{/Button}}

          {{#> Button
            type="tile"
            on-click="#switch-character.current=mini; #slides-character.jump=mini"
          }}
            <h3>{{__ "Map Figure"}}</h3>
          {{/Button}}

        {{/TileGrid}}
      {{/Slide}}
          

      {{#> Switch 
        id='switch-character'
        current=''
        forward='#switch-milestones.current'
      }}
        {{#> SwitchCase value='character'}}

          {{#> Slide jump="character" slide=1 show-next=true }}
            {{#> Row}}
              <h2>{{__ "Character"}}</h2>
              {{> Spacer}}
            
              <span>
                {{__ "Language"}}:
                {{#> Button class="btn btn--light" on-click="body.currentMenu = language-menu"}}
                  {{> Icon icon="globe"}}{{__ (languagename lang)}}
                {{/Button}}
              </span>
            {{/Row}}
              <table class="build-table">
                  <tr>
                      <th data-on-click="select ancestry">{{__ "Ancestry"}}</th>
                      <th data-on-click="select heritage">{{__ "Heritage"}}</th>
                  </tr>
                  <tr>
                      <td>
                          {{> Output name="ancestry" var="ancestry" on-click="show-menu form-select-ancestry"}}
                      </td>
                      <td>
                        {{!-- {{#> Switch
                          id="heritage"
                          current=''
                        }}
                          {{#> SwitchCase }}

                        {{/Switch}} --}}


                        <div id="swap-area:heritage" class="build-table__swap swap-area">
                            <div class="swap-option swap-option--default swap-option--show" id="swap-option:heritage:default">
                                <output name="heritage" data-select="heritage" class="output--select"></output>
                            </div>

                            {{#each pf2.selects.ancestry.values}}
                            <div class="swap-option" id="swap-option:heritage:{{id}}">
                                {{#each selects}}
                                  <!-- <h4>{{__ name}}</h4> -->
                                  {{!-- {{> Output name=(select) select=(select) }} --}}
                                  <output name="{{select}}" data-select="{{select}}" class="output--select"></output>
                                {{/each}}
                            </div>
                            {{/each}}
                        </div>
                      </td>
                  </tr>

                  <tr>
                      <th>{{__ "Background"}}</th>
                  </tr>
                  <tr>
                      <td>
                          {{> Output name="background" var="background" on-click="show-menu form-select-background"}}
                      </td>
                  </tr>

                  <tr>
                      {{!-- <th>{{__ "Class"}}</th> --}}
                      <td>
                          <h4>{{__ "Class"}}</h4>
                          <output name="class" data-select="class" class="output--select"></output>
                      </td>
                      <td>
                          <div id="swap-area:subclass" class="build-table__swap swap-area">
                              <div class="swap-option swap-option--default swap-option--show" id="swap-option:subclass:default">
                                  <h4>{{__ "Subclass"}}</h4>
                                  <output name="subclass" data-select="" class="output--select"></output>
                              </div>
                              
                              {{#each pf2.selects.class.values}}
                              <div class="swap-option" id="swap-option:subclass:{{id}}">
                                  {{#each selects}}
                                  {{#if (eq max 1)}}
                                  <h4>{{__ name}}</h4>
                                  <output name="{{select}}" data-select="{{select}}" class="output--select"></output>
                                  {{else}}
                                  <h4>{{__ name}}</h4>
                                  <div class="select-options">
                                      {{!-- {{{dump this}}} --}}
                                      {{#each values}}
                                      <label for='{{id}}'><input type='checkbox' name='{{id}}' id='{{id}}'> {{__ name}}</label> 
                                      {{/each}}
                                  </div>
                                  {{/if}}
                                  {{/each}}
                              </div>
                              {{/each}}
                          </div>
                      </td>
                  </tr>

                  <tr id="build-multiclass-row">
                      <th>{{__ "Multiclass"}}</th>
                  </tr>
                  <tr>
                      <td colspan="2">
                          <div id="list-area:multiclass" class="list-area">
                              <div class="list-item-template">
                                  <output class="list-item-name"></output>
                                  <output class="list-item-subitem"></output>
                                  <button class="btn btn--light btn--remove button-remove-multiclass list-item-remove" data-select="multiclass">{{__ "Remove"}}</button>
                              </div>
                          </div>
                          <button class="btn btn--light button-add button-add-multiclass" data-select="multiclass">{{__ "Add"}}</button>
                      </td>
                  </tr>

                  <tr id="build-archetype-row">
                      <th>{{__ "Archetype"}}</th>
                  </tr>
                  <tr>
                      <td colspan="2">
                          <div id="list-area:archetype" class="list-area">
                              <div class="list-item-template">
                                  <output class="list-item-name"></output>
                                  <output class="list-item-subitem"></output>
                                  <button class="btn btn--light btn--remove button-remove-multiclass list-item-remove" data-select="archetype">{{__ "Remove"}}</button>
                              </div>
                          </div>
                          <button class="btn btn--light button-add button-add-archetype" data-select="archetype">{{__ "Add"}}</button>
                      </td>
                  </tr>
              </table>

              {{#> Columns }}
                  {{#> Column }}
                      <h4>{{__ "Options"}}</h4>
                      <fieldset>
                          <p><label for='feat-diehard'><input type='checkbox' name='feat-diehard' id='feat-diehard'> {{__ "Diehard"}}</label></p>
                          <p><label for='debug'><input type='checkbox' name='debug' id='debug'> {{__ "Debug layouts"}}</label></p>
                      </fieldset>
                  {{/Column}}
                  {{#> Column }}
                      <h4>{{__ "Variant Rules"}}</h4>
                      <fieldset>
                          <p><label for='option-free-archetype'><input type='checkbox' name='free-archetype' id='option-free-archetype'> {{__ "Free Archetype"}}</label></p>
                          <p><label for='option-ancestry-paragon'><input type='checkbox' name='ancestry-paragon' id='option-ancestry-paragon'> {{__ "Ancestry Paragon"}}</label></p>
                          <p><label for='option-automatic-bonus-progression'><input type='checkbox' name='automatic-bonus-progression' id='option-automatic-bonus-progression'> {{__ "Automatic Bonus Progression"}}</label></p>
                          <p><label for='option-proficiency-without-level'><input type='checkbox' name='proficiency-without-level' id='option-proficiency-without-level'> {{__ "Proficiency Without Level"}}</label></p>
                      </fieldset>
                  
                  {{/Column}}
              {{/Columns}}
          {{/Slide}}
          
          {{#> Slide jump="pages" slide=3 show-next=true }}
              <h2>{{__ "Pages"}}</h2>
              <div class="row row--dense">
                {{> page-option page="permission" label="Permission to print"}}
              </div>
              <h4>{{__ "Character"}}</h4>
              <div class="row row--dense">
                  {{> page-option page="cover" label="Cover page" selected="true"}}
                  {{> page-option page="level-up" label="Level up" selected="true"}}
                  {{> page-option page="reference" label="Action Reference"}}
                  {{> page-option page="actions" label="Actions"}}
                  {{> page-option page="character-background" label="Character Background"}}
              </div>

              <h4>{{__ "Inventory"}}</h4>
              <div class="row row--dense">
                  {{> page-option size="small" page="inventory-half" label="Half" radio="true" name="inventory" value="half"}}
                  {{> page-option page="inventory-full" label="Full" selected="true" radio="true" name="inventory" value="full"}}
                  {{> page-option page="inventory-extra" label="Extra page"}}
              </div>
              

              <h4>{{__ "Companions"}}</h4>
              <div class="row row--dense">
                  {{> page-option page="animal-companion" label="Animal Companion"}}
                  {{> page-option page="familiar" label="Familiar"}}
                  {{> page-option page="construct" label="Construct"}}
              </div>
          {{/Slide}}
          
          {{#> Slide jump="colours" slide=4 show-next=true }}
              {{#> Columns}}
                  {{#> Column}}
                      <h2>{{__ "Accessibility"}}</h2>

                      <p>{{__ "Language"}}: &nbsp; <button class="btn btn--light language-button">{{ lang }}</button> {{__ (languagename lang)}}</p>

                      <h4>{{__ "Dyslexia"}}</h4>
                      <fieldset>
                          <p class='dyslexic-fonts'><input type='checkbox' id='option-dyslexic' name='option-dyslexic'> <label for='option-dyslexic'>{{__ "Dyslexic fonts"}}</label></p>
                          <p class='info'>{{__ "Uses easy-to-read fonts, disables all-caps."}}</p>
                          
                          <div class="indent">
                              <p><label for='option-dyslexic-font-dyslexie' id='font-dyslexie'><input type='radio' name='option-dyslexic-font' value='dyslexie' id='option-dyslexic-font-dyslexie' checked> Dyslexie</label> (<a href='https://dyslexiefont.com/'>dyslexiefont.com</a>)</p>
                              <p><label for='option-dyslexic-font-lexend' id='font-lexend'><input type='radio' name='option-dyslexic-font' value='lexend' id='option-dyslexic-font-lexend'> Lexend Deca</label> (<a href='https://www.lexend.com/'>lexend.com</a>)</p>
                              <p><label for='option-dyslexic-font-sans' id='font-sans'><input type='radio' name='option-dyslexic-font' value='sans' id='option-dyslexic-font-sans'> Sans-serif</label></p>
                          </dev>
                      </fieldset>

                      <h4>{{__ "Colours"}}</h4>
                      <fieldset class="high-contrast">
                          <p><span><input type='checkbox' id='option-high-contrast' name='option-high-contrast'> <label for='option-high-contrast'>{{__ "High contrast"}}</label><span></span></p>
                          <p class='info'>{{__ "Makes colours darker, removes white text."}}</p>
                      </fieldset>

                      <div class="row row--centre">
                      <button class="btn btn--primary dyslexic-preset-button">{{__ "Dyslexic Preset"}}</button>
                      </div>

                      <h4>{{__ "Large print"}}</h4>
                      <fieldset>
                          <p class='large-print'><input type='checkbox' id='option-large-print' name='option-large-print'> <label for='option-large-print'>{{__ "Large print"}}</label></p>   
                          <p class='info'>{{__ "Enlarges text and fields, omits some elements to fit on the page."}}</p>
                      </fieldset>
                  {{/Column}}
                  
                  {{#> Column}}
                      <h2>{{__ "Colours"}}</h2>

                      <div class="row">
                          {{> colour-output id="base" name="Base colour" }}
                          {{> colour-output id="accent" name="Accent colour" }}
                      </div>

                      <div class="brightness-picker">
                          <label>{{__ "Print darkness"}}</label>
                          <div class="brightness-picker__inner">
                              <div class="brightness-picker__inner2">
                                  <input type="range" min="1" max="9" value="5" name="colour-brightness">
                                  <span class="brightness-picker__notch"></span>
                              </div>
                          </div>
                      </div>

                      <h2>{{__ "Page Background"}}</h2>
                      <div class="row">

                      </div>

                  {{/Column}}
              {{/Columns}}
          {{/Slide}}
          
          {{#> Slide jump="picture" slide=5 show-next=true }}
              <h2>{{__ "Picture"}}</h2>

              <p>...</p>
          {{/Slide}}
          
          {{#> Slide jump="download" slide=6 last=true }}
              <h2>{{__ "Download"}}</h2>

              <h4>{{__ "International"}}</h4>
              <fieldset>
                  <p>{{__ "Language"}}: &nbsp; <button class="btn btn--light language-button">{{ lang }}</button> {{__ (languagename lang)}}</p>
                  <p>{{__ "Measurement units"}}: 
                      <select name="units">
                      <option selected id='units-default'>{{__ "Default"}} ({{__ "feet"}})</option>
                      <option value="imperial">{{__ "Imperial"}} ({{__ "feet"}})</option>
                      <option value="metric">{{__ "Metric"}} ({{__ "metres"}})</option>
                      {{!-- <option value="chinese">{{__ "Chinese"}} ({{__ "步"}})</option> --}}
                      </select>
                  </p>
              </fieldset>

              <h4>{{__ "Format"}}</h4>
              <fieldset>
                  <div class="columns">
                      <div class="column">
                          <p>
                              <input type='radio' name='download-format' value='html' id='download-format-html' checked>
                              <label for='download-format-html'><b>{{__ "HTML"}}</b></label>
                          </p>
                          <p class='info'>{{__ "Allows values to be filled in"}}</p>
                          <p class='info'>{{__ "Adjusts to fit your paper size"}}</p>
                      </div>
                      <div class="column">
                          <p>
                              <input type='radio' name='download-format' value='pdf' id='download-format-pdf'>
                              <label for='download-format-pdf'><b>{{__ "PDF"}}</b></label>
                          </p>
                          <p class='info'>{{__ "Use this if you have trouble printing HTML"}}</p>
                          <p class='info'>
                              <b>{{__ "Paper size:"}}</b>
                              <input type='radio' name='download-paper' value='Letter' id='download-letter' checked>
                              <label for='download-letter'>{{__ "US Letter"}}</label>

                              <input type='radio' name='download-paper' value='A4' id='download-a4'>
                              <label for='download-a4'>{{__ "A4"}}</label>
                          </p>
                      </div>
                  </div>
              </fieldset>

              <button class="place btn btn--primary button-download">{{__ "Download"}}</button>
          {{/Slide}}

        {{/SwitchCase}}

        {{#> SwitchCase value='gm'}}
          
          {{#> Slide jump="gm-pick" slide=2 }}
              <div class="grid grid--2-2">
                  <button class="stack stack--fill pick-gm-npc">
                      <p class="stack__label">{{__ "NPCs"}}</p>
                  </button>
                  <button class="stack stack--fill pick-gm-maps">
                      <p class="stack__label">{{__ "Maps"}}</p>
                  </button>
                  <button class="stack stack--fill pick-gm-kingdom">
                      <p class="stack__label">{{__ "Kingdom"}}</p>
                  </button>
              </div>
          {{/Slide}}

          {{#> Slide jump="gm-options" slide=2 show-next=true }}
              {{#> tab-panes set='gm'}}
                  {{#> tab-pane set='gm' name='npc' pane-selected=true}}
                      <h3>{{__ "NPCs"}}</h3>
                  {{/tab-pane}}

                  {{#> tab-pane set='gm' name='maps' pane-selected=true}}
                      <h3>{{__ "Maps"}}</h3>

                  {{/tab-pane}}

                  {{#> tab-pane set='gm' name='kingdom' pane-selected=true}}
                      <h3>{{__ "Kingdom"}}</h3>
                  {{/tab-pane}}
              {{/tab-panes}}
          {{/Slide}}
          
          {{#> Slide jump="gm-colours" slide=3 show-next=true }}
            <p>Colours</p>
          {{/Slide}}
          
          {{#> Slide jump="gm-download" slide=4 last=true }}
            <p>Download</p>
          {{/Slide}}
        {{/SwitchCase}}
      {{/Switch}}
    {{/Slideshow}}
  </form>
</template>

<script>
define('editionName', (value) => {
  console.log("Edition name", value);
  switch (value) {
    case 'pathfinder':
      return 'Pathfinder'
    case 'pf2-legacy':
      return 'Pathfinder 2e Legacy';
    case 'pf2-remaster':
      return 'Pathfinder 2e Remaster';
    case 'sf2':
      return 'Starfinder 2e';
    case 'all':
      return 'Both';
    default:
      return "";
  }
});
</script>
